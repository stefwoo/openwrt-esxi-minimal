#!/bin/sh

# ========================================
# 首次启动配置
# ========================================

# 设置默认语言为中文
uci set luci.main.lang='zh_cn'
uci commit luci

# 配置ttyd Web SSH
uci set ttyd.@ttyd[0]=ttyd
uci set ttyd.@ttyd[0].interface='@lan'
uci set ttyd.@ttyd[0].port='7681'
uci set ttyd.@ttyd[0].command='/bin/login'
uci commit ttyd

# 启用服务
/etc/init.d/ttyd enable

# 检查sing-box是否存在并设置权限
if [ -f /usr/bin/sing-box ]; then
    chmod +x /usr/bin/sing-box
    echo "sing-box core found and configured"
fi

# 启用momo服务（如果存在）
if [ -f /etc/init.d/momo ]; then
    /etc/init.d/momo enable
fi

exit 0
